<!doctype html>
<html>
 <head>
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@1.0.0/dist/tf.min.js"></script>
  <title>Self Camera</title>
 </head>
 <body>
   <video id="myVideo" width="500" height="500" autoplay="1" ></video>
     <h2>Camera</h2>
     <canvas id="canvas"></canvas>
     <h2 id="img"></h2>

   <script type="text/javascript">
    var video = document.getElementById("myVideo"); // 適当にvideoタグのオブジェクトを取得
    var localMediaStream = null;  
    var constrains = { video: true, audio: true }; // 映像・音声を取得するかの設定
      navigator.mediaDevices
        .getUserMedia(constrains)
        .then(function(stream) {
          video.srcObject = stream; // streamはユーザーのカメラとマイクの情報で、これをvideoの入力ソースにする
          localMediaStream = stream;
          video.play();
        })
        .catch(function(err) {
          console.log("An error occured! " + err);
        });      
       
    
        window.onload = function(){
            
          //1000ミリ秒（1秒）毎に関数「showNowDate()」を呼び出す
          setInterval("main()", 100);
        }
        
        async function main(){
           const model = await tf.loadLayersModel('./web_model/model.json');
            
            predict_niku = ["牛肉", "豚肉", "鶏肉"]
            const model = await tf.loadLayer
            if(localMediaStream){
                var canvas = new CanvasRenderingContext2D();
                var ctx = canvas.getContext('2d');
                var img = new Image();
                var w = canvas.setAttribute("width", 500);
                var h = canvas.setAttribute("height", 500);
                
                // canvasにコピー
                ctx.drawImage(video, 0, 0, w, h);
                img.src = canvas.toDataURL('imge/png');
                console.log(img);
                
            }
            console.log('hellp');
        }
       
       
   </script>
 </body>
</html>